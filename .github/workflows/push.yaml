name: "Test"
on: [push]

jobs:
  lint-frontend:
    runs-on: ubuntu-latest
    steps:
      - uses: ./.github/actions/init-env
      - run: pnpm lint

  check-frontend:
    runs-on: ubuntu-latest
    steps:
      - uses: ./.github/actions/init
      - run: pnpm check

  unittest-frontend:
    runs-on: ubuntu-latest
    steps:
      - uses: ./.github/actions/init
      - run: pnpm test

  lint-rust:
    runs-on: ubuntu-latest
    steps:
      - uses: ./.github/actions/init
      - run: cargo fmt --check
      - run: cargo install cargo-sort
      - run: cargo sort --check --workspace

  story:
    runs-on: ubuntu-latest
    steps:
      - uses: ./.github/actions/init
      - run: pnpm story:build

  test:
    runs-on: ubuntu-latest
    steps:
      - uses: ./.github/actions/init-env-tauri
      - uses: ./.github/actions/init-env-ui
      - run: pnpm build
      - run: cargo clippy --all-features
      - run: cargo test --locked
